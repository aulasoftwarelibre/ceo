{% macro ribbon(state) %}
    {% if state == 'proposed' %}
        <a class="ui yellow right ribbon label">{{ state | trans }}</a>
    {% elseif state == 'approved' %}
        <a class="ui green right ribbon label">{{ state | trans }}</a>
    {% else %}
        <a class="ui red right ribbon label">{{ state | trans }}</a>
    {% endif %}
{% endmacro %}

{% import _self as widgets %}

<div class="three wide column">
    <div class="ui center aligned basic segment counter">
        <div class="ui card">
            <div class="content">
                <div class="ui small statistic">
                    <div class="value">
                        {{ idea.votes | length }}
                    </div>
                    <div class="label">
                        Votos
                    </div>
                </div>
            </div>
            {% if idea.closed %}
            <div class="ui fluid bottom attached red button">
                CERRADA
            </div>
            {% elseif is_granted('OWNER', idea) %}
            <a class="ui fluid bottom attached green button" href="{{ path('idea_edit', {slug: idea.slug}) }}">
                EDITAR
            </a>
            {% elseif is_voted(idea) %}
            <button class="ui animated fluid bottom attached green button">
                <div class="visible content"><i class="users icon"></i></div>
                <div class="hidden content">
                    SALIR
                </div>
            </button>
            {% else %}
            <button class="ui animated fluid bottom attached button">
                <div class="visible content"><i class="plus icon"></i></div>
                <div class="hidden content">
                    UNIRTE
                </div>
            </button>
            {% endif %}
        </div>
    </div>
</div>
<div class="thirteen wide column">
    <div class="ui fluid card">
        <div class="content">
            {{ widgets.ribbon(idea.state) }}
            <a  href="{{ path('idea_show', {'slug': idea.slug}) }}" class="header">
                {{ idea.title }}
            </a>
            <div class="meta">
                Enviado {{ idea.createdAt | time_diff }} por {{ idea.owner }} a {{ idea.group }}
            </div>
            <div class="description">
                {% if complete is defined %}
                    {{ idea.description | raw }}
                {% else %}
                    {{ idea.description | striptags | truncate(200) }}
                {% endif %}
            </div>
        </div>
        <div class="extra content">
            <i class="comment icon"></i>
            {{ idea_count_comments(idea) }}
        </div>
    </div>
</div>
